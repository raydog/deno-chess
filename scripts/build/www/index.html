<html>
  <head>
    <link rel="stylesheet"
      href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css"
      integrity="sha384-q94+BZtLrkL1/ohfjR8c6L+A6qzNH9R2hBLwyoAfu3i/WCvQjzL2RQJ3uNHDISdU"
      crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2"
      crossorigin="anonymous"></script>

    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"
      integrity="sha384-8Vi8VHwn3vjQ9eUHUxex3JSN/NFqUg3QbPyX8kWyb93+8AC/pPWTzj+nHtbC5bxD"
      crossorigin="anonymous"></script>
    
    <!-- TODO: Better mod name. It's 1:40am... -->
    <script src="js/mod.js"></script>
  </head>
  <body>
    <div id="board" style="width: 400px"></div>

  <script>

    var game = DenoChess.ChessGame.NewStandardGame();

    var status = game.getStatus();

    var board = Chessboard('board', {
      draggable: true,
      position: 'start',
      onDragStart: onDragStart,
      onDrop: onDrop,
      onSnapEnd: onSnapEnd
    });


    // var board1 = Chessboard('board', 'start')

    // var board = null
    // var game = new Chess()
    // var $status = $('#status')
    // var $fen = $('#fen')
    // var $pgn = $('#pgn')

    function onDragStart (source, piece, position, orientation) {
      // do not pick up pieces if the game is over
      if (game.isGameOver()) { return false; }

      // only pick up pieces for the side to move
      if ((status.turn === 'white' && piece.search(/^b/) !== -1) ||
          (status.turn === 'black' && piece.search(/^w/) !== -1)) {
        return false
      }
    }

    function onDrop (source, target) {
      // see if the move is legal
      try {
        var move = game.move(source + target, 'Q');

      } catch (ex) {
        console.error(ex);
        return 'snapback';
      }

      status = game.getStatus();
    }

    // update the board position after the piece snap
    // for castling, en passant, pawn promotion
    function onSnapEnd () {
      board.position(game.toFENString())
    }

  </script>
  </body>
</html>
